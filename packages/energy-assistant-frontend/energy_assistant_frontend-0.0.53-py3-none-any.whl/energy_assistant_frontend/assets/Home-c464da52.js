import{M as F,N as Q,r as pe,v as X,o as me,l as m,S as b,J as y,O as C,a2 as ye,V as j,a3 as G,m as Z,w as $,Q as g,a4 as _e,$ as M,K as ee,q as re,_ as q,Z as be,c as O,a5 as J}from"./index-24107e68.js";import{_ as xe,P as we}from"./PowerFlowCard-ff18633f.js";import{V as ge}from"./VSelect-2554ab65.js";import{f as z,a as ke}from"./utils-6f3c77d7.js";import{V as Me,a as te,b as ae}from"./VCard-2b95602b.js";import{m as T,t as Ce,r as v,d as Pe,a as Ie,v as Se,c as oe,i as A,A as ie,P as $e,B as Ae,e as Be,b as Ee,C as Te,p as De,f as Re,g as Ve,D as We}from"./index-43be2ce2.js";import{V as Ne}from"./VToolbar-993b6bf4.js";import{V as je}from"./VDivider-a49a49d4.js";import{V as Oe}from"./VProgressCircular-7703b9bc.js";import"./VImg-d2963adb.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VTextField-7a038c3b.js";import"./index-90a7e407.js";import"./forwardRefs-c6f07492.js";import"./VList-33098452.js";import"./VAvatar-49c783e3.js";import"./VOverlay-6b0cfd9a.js";import"./scopeId-582fd994.js";import"./resizeObserver-6b041063.js";import"./VSlideGroup-3231dc03.js";const ze={key:0,class:"mt-2 w-full items-center rounded-md bg-subgroup px-2 pt-1"},Fe=F({__name:"PowerModeSelection",props:{deviceId:{},supportedPowerModes:{},powerMode:{}},setup(e){const{t:a}=Q();function t(i){return{title:a("power_mode."+i),mode:i}}let r=pe("device_controlled");const o=e;return X(r,()=>{console.log("powerModeModel selection: "+r.value),console.log("watch on change power mode: "+r.value),r.value!=""&&G.setPowerMode(o.deviceId,r.value)}),X(()=>o.powerMode,(i,n)=>{console.log("watch power mode: "+r.value),r.value=o.powerMode}),me(()=>{r.value=o.powerMode,console.log("onMounted power mode: "+r.value)}),(i,n)=>i.supportedPowerModes&&i.supportedPowerModes.length>1&&i.powerMode?(m(),b("div",ze,[y(ge,{modelValue:C(r),"onUpdate:modelValue":n[0]||(n[0]=s=>ye(r)?r.value=s:r=s),class:"my-4",items:i.supportedPowerModes.map(s=>t(s)),"item-title":"title","item-value":"mode","single-line":""},null,8,["modelValue","items"])])):j("",!0)}}),Le={class:""},He={class:"grid w-full grid-cols-1"},Ue={key:0,class:"mt-2 items-center rounded-md bg-subgroup p-2"},Ge={class:"float-right"},Xe={key:1,class:"mt-2 text-center rounded-md bg-error p-2"},qe={class:"mt-2 items-center rounded-md bg-subgroup p-2"},Je={key:0,class:"text-left"},Ke={class:"float-right"},Ye=F({__name:"DeviceCard",props:{device:{},available:{type:Boolean},power:{},today:{},attributes:{}},setup(e){const{t:a}=Q();function t(r,o){switch(r){case"session_time":return ke(o);case"session_energy":case"session_solar_energy":return z(parseFloat(o),"kWh")}return o}return(r,o)=>(m(),Z(ae,{class:"m-4 w-80 sm:w-96 p-4 rounded-md elevation-2"},{default:$(()=>[y(Me,null,{default:$(()=>[g("span",{class:_e(["mdi pr-2",r.device.icon])},null,2),g("span",Le,M(r.device.name),1)]),_:1}),y(te,null,{default:$(()=>[g("div",He,[r.available&&r.attributes&&Object.entries(r.attributes).length>0?(m(),b("div",Ue,[(m(!0),b(ee,null,re(Object.entries(r.attributes),(i,n)=>(m(),b("div",{key:n,class:"text-left"},[q(M(C(a)("device_attribute."+i[0]))+" ",1),g("span",Ge,M(t(i[0],i[1])),1)]))),128))])):j("",!0),r.available?j("",!0):(m(),b("div",Xe,M(r.$t("unavailable")),1)),g("div",qe,[r.available?(m(),b("div",Je,[q(M(C(a)("consumption"))+" ",1),g("span",Ke,M(C(z)(r.power,"W")),1)])):j("",!0),y(xe,{"self-sufficiency":r.today.self_sufficiency,"consumed-energy":r.today.consumed_energy,"consumed-solar-energy":r.today.consumed_solar_energy},null,8,["self-sufficiency","consumed-energy","consumed-solar-energy"])])]),y(Fe,{"device-id":r.device.id,"supported-power-modes":r.device.supported_power_modes,"power-mode":r.device.power_mode},null,8,["device-id","supported-power-modes","power-mode"])]),_:1})]),_:1}))}});/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var K=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),B={toTextLines:function(e){var a=[],t;for(e=[].concat(e);e.length;)t=e.pop(),typeof t=="string"?a.unshift.apply(a,t.split(`
`)):Array.isArray(t)?e.push.apply(e,t):A(e)||a.unshift(""+t);return a},textSize:function(e,a,t){var r=[].concat(a),o=r.length,i=e.font,n=0,s;for(e.font=t.string,s=0;s<o;++s)n=Math.max(e.measureText(r[s]).width,n);return e.font=i,{height:o*t.lineHeight,width:n}},bound:function(e,a,t){return Math.max(e,Math.min(a,t))},arrayDiff:function(e,a){var t=e.slice(),r=[],o,i,n,s;for(o=0,n=a.length;o<n;++o)s=a[o],i=t.indexOf(s),i===-1?r.push([s,1]):t.splice(i,1);for(o=0,n=t.length;o<n;++o)r.push([t[o],-1]);return r},rasterize:function(e){return Math.round(e*K)/K}};function H(e,a){var t=a.x,r=a.y;if(t===null)return{x:0,y:-1};if(r===null)return{x:1,y:0};var o=e.x-t,i=e.y-r,n=Math.sqrt(o*o+i*i);return{x:n?o/n:0,y:n?i/n:-1}}function Qe(e,a,t,r,o){switch(o){case"center":t=r=0;break;case"bottom":t=0,r=1;break;case"right":t=1,r=0;break;case"left":t=-1,r=0;break;case"top":t=0,r=-1;break;case"start":t=-t,r=-r;break;case"end":break;default:o*=Math.PI/180,t=Math.cos(o),r=Math.sin(o);break}return{x:e,y:a,vx:t,vy:r}}var Ze=0,ne=1,se=2,le=4,de=8;function R(e,a,t){var r=Ze;return e<t.left?r|=ne:e>t.right&&(r|=se),a<t.top?r|=de:a>t.bottom&&(r|=le),r}function er(e,a){for(var t=e.x0,r=e.y0,o=e.x1,i=e.y1,n=R(t,r,a),s=R(o,i,a),d,l,u;!(!(n|s)||n&s);)d=n||s,d&de?(l=t+(o-t)*(a.top-r)/(i-r),u=a.top):d&le?(l=t+(o-t)*(a.bottom-r)/(i-r),u=a.bottom):d&se?(u=r+(i-r)*(a.right-t)/(o-t),l=a.right):d&ne&&(u=r+(i-r)*(a.left-t)/(o-t),l=a.left),d===n?(t=l,r=u,n=R(t,r,a)):(o=l,i=u,s=R(o,i,a));return{x0:t,x1:o,y0:r,y1:i}}function V(e,a){var t=a.anchor,r=e,o,i;return a.clamp&&(r=er(r,a.area)),t==="start"?(o=r.x0,i=r.y0):t==="end"?(o=r.x1,i=r.y1):(o=(r.x0+r.x1)/2,i=(r.y0+r.y1)/2),Qe(o,i,e.vx,e.vy,a.align)}var W={arc:function(e,a){var t=(e.startAngle+e.endAngle)/2,r=Math.cos(t),o=Math.sin(t),i=e.innerRadius,n=e.outerRadius;return V({x0:e.x+r*i,y0:e.y+o*i,x1:e.x+r*n,y1:e.y+o*n,vx:r,vy:o},a)},point:function(e,a){var t=H(e,a.origin),r=t.x*e.options.radius,o=t.y*e.options.radius;return V({x0:e.x-r,y0:e.y-o,x1:e.x+r,y1:e.y+o,vx:t.x,vy:t.y},a)},bar:function(e,a){var t=H(e,a.origin),r=e.x,o=e.y,i=0,n=0;return e.horizontal?(r=Math.min(e.x,e.base),i=Math.abs(e.base-e.x)):(o=Math.min(e.y,e.base),n=Math.abs(e.base-e.y)),V({x0:r,y0:o+n,x1:r+i,y1:o,vx:t.x,vy:t.y},a)},fallback:function(e,a){var t=H(e,a.origin);return V({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:t.x,vy:t.y},a)}},w=B.rasterize;function rr(e){var a=e.borderWidth||0,t=e.padding,r=e.size.height,o=e.size.width,i=-o/2,n=-r/2;return{frame:{x:i-t.left-a,y:n-t.top-a,w:o+t.width+a*2,h:r+t.height+a*2},text:{x:i,y:n,w:o,h:r}}}function tr(e,a){var t=a.chart.getDatasetMeta(a.datasetIndex).vScale;if(!t)return null;if(t.xCenter!==void 0&&t.yCenter!==void 0)return{x:t.xCenter,y:t.yCenter};var r=t.getBasePixel();return e.horizontal?{x:r,y:null}:{x:null,y:r}}function ar(e){return e instanceof ie?W.arc:e instanceof $e?W.point:e instanceof Ae?W.bar:W.fallback}function or(e,a,t,r,o,i){var n=Math.PI/2;if(i){var s=Math.min(i,o/2,r/2),d=a+s,l=t+s,u=a+r-s,f=t+o-s;e.moveTo(a,l),d<u&&l<f?(e.arc(d,l,s,-Math.PI,-n),e.arc(u,l,s,-n,0),e.arc(u,f,s,0,n),e.arc(d,f,s,n,Math.PI)):d<u?(e.moveTo(d,t),e.arc(u,l,s,-n,n),e.arc(d,l,s,n,Math.PI+n)):l<f?(e.arc(d,l,s,-Math.PI,0),e.arc(d,f,s,0,Math.PI)):e.arc(d,l,s,-Math.PI,Math.PI),e.closePath(),e.moveTo(a,t)}else e.rect(a,t,r,o)}function ir(e,a,t){var r=t.backgroundColor,o=t.borderColor,i=t.borderWidth;!r&&(!o||!i)||(e.beginPath(),or(e,w(a.x)+i/2,w(a.y)+i/2,w(a.w)-i,w(a.h)-i,t.borderRadius),e.closePath(),r&&(e.fillStyle=r,e.fill()),o&&i&&(e.strokeStyle=o,e.lineWidth=i,e.lineJoin="miter",e.stroke()))}function nr(e,a,t){var r=t.lineHeight,o=e.w,i=e.x,n=e.y+r/2;return a==="center"?i+=o/2:(a==="end"||a==="right")&&(i+=o),{h:r,w:o,x:i,y:n}}function sr(e,a,t){var r=e.shadowBlur,o=t.stroked,i=w(t.x),n=w(t.y),s=w(t.w);o&&e.strokeText(a,i,n,s),t.filled&&(r&&o&&(e.shadowBlur=0),e.fillText(a,i,n,s),r&&o&&(e.shadowBlur=r))}function lr(e,a,t,r){var o=r.textAlign,i=r.color,n=!!i,s=r.font,d=a.length,l=r.textStrokeColor,u=r.textStrokeWidth,f=l&&u,h;if(!(!d||!n&&!f))for(t=nr(t,o,s),e.font=s.string,e.textAlign=o,e.textBaseline="middle",e.shadowBlur=r.textShadowBlur,e.shadowColor=r.textShadowColor,n&&(e.fillStyle=i),f&&(e.lineJoin="round",e.lineWidth=u,e.strokeStyle=l),h=0,d=a.length;h<d;++h)sr(e,a[h],{stroked:f,filled:n,w:t.w,x:t.x,y:t.y+t.h*h})}var ue=function(e,a,t,r){var o=this;o._config=e,o._index=r,o._model=null,o._rects=null,o._ctx=a,o._el=t};T(ue.prototype,{_modelize:function(e,a,t,r){var o=this,i=o._index,n=Ce(v([t.font,{}],r,i)),s=v([t.color,Pe.color],r,i);return{align:v([t.align,"center"],r,i),anchor:v([t.anchor,"center"],r,i),area:r.chart.chartArea,backgroundColor:v([t.backgroundColor,null],r,i),borderColor:v([t.borderColor,null],r,i),borderRadius:v([t.borderRadius,0],r,i),borderWidth:v([t.borderWidth,0],r,i),clamp:v([t.clamp,!1],r,i),clip:v([t.clip,!1],r,i),color:s,display:e,font:n,lines:a,offset:v([t.offset,4],r,i),opacity:v([t.opacity,1],r,i),origin:tr(o._el,r),padding:Ie(v([t.padding,4],r,i)),positioner:ar(o._el),rotation:v([t.rotation,0],r,i)*(Math.PI/180),size:B.textSize(o._ctx,a,n),textAlign:v([t.textAlign,"start"],r,i),textShadowBlur:v([t.textShadowBlur,0],r,i),textShadowColor:v([t.textShadowColor,s],r,i),textStrokeColor:v([t.textStrokeColor,s],r,i),textStrokeWidth:v([t.textStrokeWidth,0],r,i)}},update:function(e){var a=this,t=null,r=null,o=a._index,i=a._config,n,s,d,l=v([i.display,!0],e,o);l&&(n=e.dataset.data[o],s=Se(oe(i.formatter,[n,e]),n),d=A(s)?[]:B.toTextLines(s),d.length&&(t=a._modelize(l,d,i,e),r=rr(t))),a._model=t,a._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,a){var t=this,r=e.ctx,o=t._model,i=t._rects,n;this.visible()&&(r.save(),o.clip&&(n=o.area,r.beginPath(),r.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),r.clip()),r.globalAlpha=B.bound(0,o.opacity,1),r.translate(w(a.x),w(a.y)),r.rotate(o.rotation),ir(r,i.frame,o),lr(r,o.lines,i.text,o),r.restore())}});var dr=Number.MIN_SAFE_INTEGER||-9007199254740991,ur=Number.MAX_SAFE_INTEGER||9007199254740991;function S(e,a,t){var r=Math.cos(t),o=Math.sin(t),i=a.x,n=a.y;return{x:i+r*(e.x-i)-o*(e.y-n),y:n+o*(e.x-i)+r*(e.y-n)}}function Y(e,a){var t=ur,r=dr,o=a.origin,i,n,s,d,l;for(i=0;i<e.length;++i)n=e[i],s=n.x-o.x,d=n.y-o.y,l=a.vx*s+a.vy*d,t=Math.min(t,l),r=Math.max(r,l);return{min:t,max:r}}function N(e,a){var t=a.x-e.x,r=a.y-e.y,o=Math.sqrt(t*t+r*r);return{vx:(a.x-e.x)/o,vy:(a.y-e.y)/o,origin:e,ln:o}}var fe=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};T(fe.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,a,t){this._rotation=t,this._rect={x:a.x+e.x,y:a.y+e.y,w:a.w,h:a.h}},contains:function(e){var a=this,t=1,r=a._rect;return e=S(e,a.center(),-a._rotation),!(e.x<r.x-t||e.y<r.y-t||e.x>r.x+r.w+t*2||e.y>r.y+r.h+t*2)},intersects:function(e){var a=this._points(),t=e._points(),r=[N(a[0],a[1]),N(a[0],a[3])],o,i,n;for(this._rotation!==e._rotation&&r.push(N(t[0],t[1]),N(t[0],t[3])),o=0;o<r.length;++o)if(i=Y(a,r[o]),n=Y(t,r[o]),i.max<n.min||n.max<i.min)return!1;return!0},_points:function(){var e=this,a=e._rect,t=e._rotation,r=e.center();return[S({x:a.x,y:a.y},r,t),S({x:a.x+a.w,y:a.y},r,t),S({x:a.x+a.w,y:a.y+a.h},r,t),S({x:a.x,y:a.y+a.h},r,t)]}});function ve(e,a,t){var r=a.positioner(e,a),o=r.vx,i=r.vy;if(!o&&!i)return{x:r.x,y:r.y};var n=t.w,s=t.h,d=a.rotation,l=Math.abs(n/2*Math.cos(d))+Math.abs(s/2*Math.sin(d)),u=Math.abs(n/2*Math.sin(d))+Math.abs(s/2*Math.cos(d)),f=1/Math.max(Math.abs(o),Math.abs(i));return l*=o*f,u*=i*f,l+=a.offset*o,u+=a.offset*i,{x:r.x+l,y:r.y+u}}function fr(e,a){var t,r,o,i;for(t=e.length-1;t>=0;--t)for(o=e[t].$layout,r=t-1;r>=0&&o._visible;--r)i=e[r].$layout,i._visible&&o._box.intersects(i._box)&&a(o,i);return e}function vr(e){var a,t,r,o,i,n,s;for(a=0,t=e.length;a<t;++a)r=e[a],o=r.$layout,o._visible&&(s=new Proxy(r._el,{get:(d,l)=>d.getProps([l],!0)[l]}),i=r.geometry(),n=ve(s,r.model(),i),o._box.update(n,i,r.rotation()));return fr(e,function(d,l){var u=d._hidable,f=l._hidable;u&&f||f?l._visible=!1:u&&(d._visible=!1)})}var E={prepare:function(e){var a=[],t,r,o,i,n;for(t=0,o=e.length;t<o;++t)for(r=0,i=e[t].length;r<i;++r)n=e[t][r],a.push(n),n.$layout={_box:new fe,_hidable:!1,_visible:!0,_set:t,_idx:n._index};return a.sort(function(s,d){var l=s.$layout,u=d.$layout;return l._idx===u._idx?u._set-l._set:u._idx-l._idx}),this.update(a),a},update:function(e){var a=!1,t,r,o,i,n;for(t=0,r=e.length;t<r;++t)o=e[t],i=o.model(),n=o.$layout,n._hidable=i&&i.display==="auto",n._visible=o.visible(),a|=n._hidable;a&&vr(e)},lookup:function(e,a){var t,r;for(t=e.length-1;t>=0;--t)if(r=e[t].$layout,r&&r._visible&&r._box.contains(a))return e[t];return null},draw:function(e,a){var t,r,o,i,n,s;for(t=0,r=a.length;t<r;++t)o=a[t],i=o.$layout,i._visible&&(n=o.geometry(),s=ve(o._el,o.model(),n),i._box.update(s,n,o.rotation()),o.draw(e,s))}},cr=function(e){if(A(e))return null;var a=e,t,r,o;if(Ee(e))if(!A(e.label))a=e.label;else if(!A(e.r))a=e.r;else for(a="",t=Object.keys(e),o=0,r=t.length;o<r;++o)a+=(o!==0?", ":"")+t[o]+": "+e[t[o]];return""+a},hr={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:cr,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},c="$datalabels",ce="$default";function pr(e,a){var t=e.datalabels,r={},o=[],i,n;return t===!1?null:(t===!0&&(t={}),a=T({},[a,t]),i=a.labels||{},n=Object.keys(i),delete a.labels,n.length?n.forEach(function(s){i[s]&&o.push(T({},[a,i[s],{_key:s}]))}):o.push(a),r=o.reduce(function(s,d){return Be(d.listeners||{},function(l,u){s[u]=s[u]||{},s[u][d._key||ce]=l}),delete d.listeners,s},{}),{labels:o,listeners:r})}function U(e,a,t,r){if(a){var o=t.$context,i=t.$groups,n;a[i._set]&&(n=a[i._set][i._key],n&&oe(n,[o,r])===!0&&(e[c]._dirty=!0,t.update(o)))}}function mr(e,a,t,r,o){var i,n;!t&&!r||(t?r?t!==r&&(n=i=!0):n=!0:i=!0,n&&U(e,a.leave,t,o),i&&U(e,a.enter,r,o))}function yr(e,a){var t=e[c],r=t._listeners,o,i;if(!(!r.enter&&!r.leave)){if(a.type==="mousemove")i=E.lookup(t._labels,a);else if(a.type!=="mouseout")return;o=t._hovered,t._hovered=i,mr(e,r,o,i,a)}}function _r(e,a){var t=e[c],r=t._listeners.click,o=r&&E.lookup(t._labels,a);o&&U(e,r,o,a)}var br={id:"datalabels",defaults:hr,beforeInit:function(e){e[c]={_actives:[]}},beforeUpdate:function(e){var a=e[c];a._listened=!1,a._listeners={},a._datasets=[],a._labels=[]},afterDatasetUpdate:function(e,a,t){var r=a.index,o=e[c],i=o._datasets[r]=[],n=e.isDatasetVisible(r),s=e.data.datasets[r],d=pr(s,t),l=a.meta.data||[],u=e.ctx,f,h,P,I,_,k,p,x;for(u.save(),f=0,P=l.length;f<P;++f)if(p=l[f],p[c]=[],n&&p&&e.getDataVisibility(f)&&!p.skip)for(h=0,I=d.labels.length;h<I;++h)_=d.labels[h],k=_._key,x=new ue(_,u,p,f),x.$groups={_set:r,_key:k||ce},x.$context={active:!1,chart:e,dataIndex:f,dataset:s,datasetIndex:r},x.update(x.$context),p[c].push(x),i.push(x);u.restore(),T(o._listeners,d.listeners,{merger:function(D,L,he){L[D]=L[D]||{},L[D][a.index]=he[D],o._listened=!0}})},afterUpdate:function(e){e[c]._labels=E.prepare(e[c]._datasets)},afterDatasetsDraw:function(e){E.draw(e,e[c]._labels)},beforeEvent:function(e,a){if(e[c]._listened){var t=a.event;switch(t.type){case"mousemove":case"mouseout":yr(e,t);break;case"click":_r(e,t);break}}},afterEvent:function(e){var a=e[c],t=a._actives,r=a._actives=e.getActiveElements(),o=B.arrayDiff(t,r),i,n,s,d,l,u,f;for(i=0,n=o.length;i<n;++i)if(l=o[i],l[1])for(f=l[0].element[c]||[],s=0,d=f.length;s<d;++s)u=f[s],u.$context.active=l[1]===1,u.update(u.$context);(a._dirty||o.length)&&(E.update(a._labels),e.render()),delete a._dirty}};const xr="bold",wr=F({__name:"DevicePowerDistributionCard",props:{devices:{},power:{},selfSufficiency:{}},setup(e){const a=be(),t={id:"doughnutlabel",beforeDraw:(n,s,d)=>{const{ctx:l}=n;l.save(),l.globalCompositeOperation="destination-over";var u=n.chartArea.width,f=n.chartArea.height;l.font="1.2em sans-serif",l.fillStyle=d.color;const h=2;l.textBaseline="top";let P=0;for(let _=0;_<d.text.length;_++){const k=d.text[_],p=l.measureText(k);P+=(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent)*h}let I=n.chartArea.top+(f-P)/2;for(let _=0;_<d.text.length;_++){const k=d.text[_],p=l.measureText(k),x=n.chartArea.left+Math.round((u-p.width)/2);l.fillText(k,x,I),I+=(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent)*h}l.restore()},defaults:{text:[],color:"black"}},r=O(()=>{const n=i.devices.filter(s=>s.power>0);return{labels:n.map(s=>G.getDeviceInfo(s.device_id).name),datasets:[{data:n.map(s=>s.power)}]}}),o=O(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:a.current.value.colors["on-surface"]}},tooltip:{callbacks:{label:n=>`${z(n.parsed,"W")}`}},doughnutlabel:{color:a.current.value.colors["on-surface"],text:[z(i.power,"W"),i.selfSufficiency.toFixed(0)+"%"]},datalabels:{backgroundColor:function(n){return n.dataset.backgroundColor},borderColor:"white",borderRadius:25,borderWidth:2,color:"white",display:function(n){var s=n.dataset;const d=s.data.reduce((u,f)=>u+f,0);var l=s.data[n.dataIndex];return l>d/10},font:{weight:xr},padding:6,formatter:Math.round}}}));Te.register(ie,De,Re,Ve,t,br);const i=e;return(n,s)=>(m(),Z(ae,{class:"m-4 w-80 sm:w-96 p-4 rounded-md elevation-2"},{default:$(()=>[y(te,null,{default:$(()=>[y(C(We),{data:r.value,options:o.value},null,8,["data","options"])]),_:1})]),_:1}))}}),gr={class:"flex min-h-screen w-full justify-center"},kr={key:0,class:"flex w-full justify-items-center p-4"},Mr={key:1},Cr={class:"grid grid-cols-1 lg:grid-cols-2 p-4 bg-background"},Gr=F({__name:"Home",setup(e){const a=O(()=>J.home),t=O(()=>J.state.connected);return(r,o)=>(m(),b("div",null,[y(Ne,{color:"transparent",title:a.value.name},null,8,["title"]),y(je),g("div",gr,[t.value?(m(),b("div",Mr,[g("div",Cr,[y(we,{"home-consumption-power":a.value.power.home_consumption,"solar-power":a.value.power.solar_production,unit:"W"},null,8,["home-consumption-power","solar-power"]),y(wr,{devices:a.value.devices,power:a.value.power.home_consumption,"self-sufficiency":a.value.power.self_sufficiency},null,8,["devices","power","self-sufficiency"]),(m(!0),b(ee,null,re(a.value.devices,(i,n)=>(m(),b("div",{key:n},[y(Ye,{device:C(G).getDeviceInfo(i.device_id),available:i.available,power:i.power,today:i.today,attributes:i.attributes},null,8,["device","available","power","today","attributes"])]))),128))])])):(m(),b("div",kr,[y(Oe,{indeterminate:"",color:"primary"})]))])]))}});export{Gr as default};
