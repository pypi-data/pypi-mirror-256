import{s as k,e as b,c as p,b as E,f as g,i as N,n as L,p as X,R as Y,C as P,S as Z,I as q,a as S,g as $,m as _,h as V,t as ee,d as te,j as ie}from"./scheduler.HHbpe561.js";import{S as x,i as D,f as ne,b as W,d as z,m as K,a as M,t as R,e as G}from"./index.zjc5z22-.js";import{g as se,v as ae,e as re}from"./command.I2m8XSFA.js";const oe=new Set(["width","height"]);var le=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,a,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(a=n;a--!==0;)if(!i(e[a],t[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[a]))return!1;for(a=n;a--!==0;){var r=s[a];if(!i(e[r],t[r]))return!1}return!0}return e!==e&&t!==t};const fe=se(le);function ce(i,e){for(const[t,n]of Object.entries(e))n&&(n&&{}.toString.call(n)==="[object Function]"?n(i.data(t)):i.change(t,ae.changeset().remove(()=>!0).insert(n)))}function y(i={},e={},t=new Set){const n=Object.keys(i),a=Object.keys(e);return i===e||n.length===a.length&&n.filter(s=>!t.has(s)).every(s=>i[s]===e[s])}function A(i,e){const t=Object.keys(e);for(const n of t)try{i.removeSignalListener(n,e[n])}catch(a){console.warn("Cannot remove invalid signal listener.",a)}return t.length>0}function O(i,e){const t=Object.keys(e);for(const n of t)try{i.addSignalListener(n,e[n])}catch(a){console.warn("Cannot add invalid signal listener.",a)}return t.length>0}function ue(i){return new Set(i.flatMap(e=>Object.keys(e)))}function he(i,e){if(i===e)return!1;const t={width:!1,height:!1,isExpensive:!1},n="width"in i||"width"in e,a="height"in i||"height"in e;return n&&(!("width"in i)||!("width"in e)||i.width!==e.width)&&("width"in i&&typeof i.width=="number"?t.width=i.width:t.isExpensive=!0),a&&(!("height"in i)||!("height"in e)||i.height!==e.height)&&("height"in i&&typeof i.height=="number"?t.height=i.height:t.isExpensive=!0),[...ue([i,e])].filter(r=>r!=="width"&&r!=="height").some(r=>!(r in i)||!(r in e)||!fe(i[r],e[r]))&&(t.isExpensive=!0),t.width!==!1||t.height!==!1||t.isExpensive?t:!1}function I(i,e){const{width:t,height:n}=e;return typeof t<"u"&&typeof n<"u"?{...i,width:t,height:n}:typeof t<"u"?{...i,width:t}:typeof n<"u"?{...i,height:n}:i}function ge(i){let e;return{c(){e=b("div")},l(t){e=p(t,"DIV",{}),E(e).forEach(g)},m(t,n){N(t,e,n),i[11](e)},p:L,i:L,o:L,d(t){t&&g(e),i[11](null)}}}function de(i,e,t){let{options:n}=e,{spec:a}=e,{view:s}=e,{signalListeners:r={}}=e,{data:o={}}=e;const f=X();let l,h={},v={},u={},j={},w;Y(()=>{C()});async function H(){C();try{t(6,l=await re(w,a,n)),t(1,s=l.view),O(s,r)&&s.runAsync(),B(s)}catch(c){U(c)}}function C(){l&&(l.finalize(),t(6,l=void 0),t(1,s=void 0))}function U(c){f("onError",{error:c}),console.warn(c)}function B(c){T(),f("onNewView",{view:c})}async function T(){o&&Object.keys(o).length>0&&l!==void 0&&(t(1,s=l.view),ce(s,o),await s.resize().runAsync())}function J(c){P[c?"unshift":"push"](()=>{w=c,t(0,w)})}return i.$$set=c=>{"options"in c&&t(2,n=c.options),"spec"in c&&t(3,a=c.spec),"view"in c&&t(1,s=c.view),"signalListeners"in c&&t(4,r=c.signalListeners),"data"in c&&t(5,o=c.data)},i.$$.update=()=>{if(i.$$.dirty&1056&&(y(o,j)||T(),t(10,j=o)),i.$$.dirty&991&&w!==void 0){if(!y(n,h,oe))H();else{const c=he(I(a,n),I(u,h)),d=r,m=v;if(c){if(c.isExpensive)H();else if(l!==void 0){const Q=!y(d,m);t(1,s=l.view),c.width!==!1&&s.width(c.width),c.height!==!1&&s.height(c.height),Q&&(m&&A(s,m),d&&O(s,d)),s.runAsync()}}else!y(d,m)&&l!==void 0&&(t(1,s=l.view),m&&A(s,m),d&&O(s,d),s.runAsync())}t(7,h=n),t(8,v=r),t(9,u=a)}},[w,s,n,a,r,o,l,h,v,u,j,J]}class me extends x{constructor(e){super(),D(this,e,de,ge,k,{options:2,spec:3,view:1,signalListeners:4,data:5})}}function ve(i){let e,t,n;function a(r){i[6](r)}let s={spec:i[1],data:i[2],signalListeners:i[3],options:i[4]};return i[0]!==void 0&&(s.view=i[0]),e=new me({props:s}),P.push(()=>ne(e,"view",a)),e.$on("onNewView",i[7]),e.$on("onError",i[8]),{c(){W(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){K(e,r,o),n=!0},p(r,[o]){const f={};o&2&&(f.spec=r[1]),o&4&&(f.data=r[2]),o&8&&(f.signalListeners=r[3]),o&16&&(f.options=r[4]),!t&&o&1&&(t=!0,f.view=r[0],Z(()=>t=!1)),e.$set(f)},i(r){n||(M(e.$$.fragment,r),n=!0)},o(r){R(e.$$.fragment,r),n=!1},d(r){G(e,r)}}}const we="vega-lite";function ye(i,e,t){let n,{spec:a}=e,{options:s={}}=e,{data:r={}}=e,{signalListeners:o={}}=e,{view:f=void 0}=e;function l(u){f=u,t(0,f)}function h(u){q.call(this,i,u)}function v(u){q.call(this,i,u)}return i.$$set=u=>{"spec"in u&&t(1,a=u.spec),"options"in u&&t(5,s=u.options),"data"in u&&t(2,r=u.data),"signalListeners"in u&&t(3,o=u.signalListeners),"view"in u&&t(0,f=u.view)},i.$$.update=()=>{i.$$.dirty&32&&t(4,n={...s,mode:we})},[f,a,r,o,n,s,l,h,v]}class _e extends x{constructor(e){super(),D(this,e,ye,ve,k,{spec:1,options:5,data:2,signalListeners:3,view:0})}}function F(i){let e,t=i[0].name+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(a){e=p(a,"SPAN",{class:!0});var s=E(e);n=te(s,t),s.forEach(g),this.h()},h(){_(e,"class","py-1 text-sm font-bold")},m(a,s){N(a,e,s),V(e,n)},p(a,s){s&1&&t!==(t=a[0].name+"")&&ie(n,t)},d(a){a&&g(e)}}}function be(i){let e,t,n,a,s,r,o=!i[2]&&F(i);return a=new _e({props:{spec:i[3],options:i[4]}}),{c(){e=b("div"),o&&o.c(),t=S(),n=b("div"),W(a.$$.fragment),this.h()},l(f){e=p(f,"DIV",{class:!0});var l=E(e);o&&o.l(l),t=$(l),n=p(l,"DIV",{class:!0});var h=E(n);z(a.$$.fragment,h),h.forEach(g),l.forEach(g),this.h()},h(){_(n,"class","place-items-center overflow-y-scroll"),_(e,"class",s="max-h-"+i[1]+" w-72 mx-auto flex flex-col justify-center items-center")},m(f,l){N(f,e,l),o&&o.m(e,null),V(e,t),V(e,n),K(a,n,null),r=!0},p(f,[l]){f[2]?o&&(o.d(1),o=null):o?o.p(f,l):(o=F(f),o.c(),o.m(e,t)),(!r||l&2&&s!==(s="max-h-"+f[1]+" w-72 mx-auto flex flex-col justify-center items-center"))&&_(e,"class",s)},i(f){r||(M(a.$$.fragment,f),r=!0)},o(f){R(a.$$.fragment,f),r=!1},d(f){f&&g(e),o&&o.d(),G(a)}}}function pe(i,e,t){let{hist:n}=e,{maxHeight:a=48}=e,{hideTitle:s=!1}=e,r=7.5*n.histogram.length;r=r<125?125:r;const o={$schema:"https://vega.github.io/schema/vega-lite/v5.json",config:{style:{cell:{stroke:"transparent"}}},params:[{name:"highlight",select:{type:"point",on:"mouseover"}}],data:{values:n.histogram},height:r,width:150,background:"transparent",mark:{type:"bar",tooltip:!0},encoding:{x:{field:"counts",type:"quantitative",axis:{title:null,grid:!1,domain:!1,ticks:!1,labels:!1}},y:{field:n.type=="categorical"?n.name:"bin_range",type:"nominal",sort:"x",axis:{title:null,domain:!1,grid:!1,ticks:!1,labelLimit:50,labelPadding:10}},color:{condition:[{param:"highlight",empty:!1,value:"grey"}],field:"split"}}};if(n.type=="numerical")for(let l=0;l<n.histogram.length;++l){const h=n.histogram[l];h.bin_range=h.bin_start+"-"+h.bin_end}const f={actions:!1};return i.$$set=l=>{"hist"in l&&t(0,n=l.hist),"maxHeight"in l&&t(1,a=l.maxHeight),"hideTitle"in l&&t(2,s=l.hideTitle)},[n,a,s,o,f]}class Oe extends x{constructor(e){super(),D(this,e,pe,be,k,{hist:0,maxHeight:1,hideTitle:2})}}export{Oe as H};
