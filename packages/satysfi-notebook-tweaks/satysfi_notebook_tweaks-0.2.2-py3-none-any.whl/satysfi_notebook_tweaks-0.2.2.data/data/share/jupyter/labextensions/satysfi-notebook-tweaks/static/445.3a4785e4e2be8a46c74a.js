"use strict";(self.webpackChunksatysfi_notebook_tweaks=self.webpackChunksatysfi_notebook_tweaks||[]).push([[445],{445:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var s=n(196),o=n(29),a=n(86);const r="satysfi-notebook-tweaks:export-pdf";var i=n(601);const l={id:"satysfi-notebook-tweaks:plugin",description:"A small tweaks for SATySFi Notebook environment.",autoStart:!0,requires:[s.ICommandPalette,a.IRenderMimeRegistry],activate:(e,t,n)=>{e.commands.addCommand(r,{label:"SATySFi Notebook: Export entire document as PDF",isVisible:()=>{var t;const n=e.shell.currentWidget;return n instanceof o.NotebookPanel&&"satysfi"===(null===(t=n.sessionContext.kernelPreference.language)||void 0===t?void 0:t.toLowerCase())},execute:()=>(async(e,t)=>{var n;const r=e.shell.currentWidget;if(!(r instanceof o.NotebookPanel&&r.model))return;const l=null===(n=r.sessionContext.session)||void 0===n?void 0:n.kernel;if(!l)return;const d=r.model.sharedModel.cells.filter((({cell_type:e})=>"code"===e)),c=d.map((({source:e})=>e)).filter((e=>e.startsWith("%!"))),u=d.filter((({source:e})=>!e.startsWith("%!")&&!e.startsWith("%?")&&!e.startsWith("%%"))).map((({source:e})=>e)).join("\n"),m=e.serviceManager.kernels.startNew({name:l.name},{clientId:l.clientId,username:l.username,handleComms:l.handleComms}),f=await["%% render-in-pdf",...c].reduce((async(e,t)=>e.then((e=>new Promise(((n,s)=>{e.requestExecute({code:t}).onIOPub=t=>{i.KernelMessage.isStatusMsg(t)&&"idle"===t.content.execution_state&&n(e),i.KernelMessage.isErrorMsg(t)&&s(new Error(t.content.evalue))}}))))),m);f.requestExecute({code:u}).onIOPub=n=>{if(!i.KernelMessage.isExecuteResultMsg(n))return;f.shutdown();const o=t.createRenderer("application/pdf"),l=new s.MainAreaWidget({content:o});l.title.label=`PDF Export: ${r.title.label}`,l.id=`${r.id}-exported-pdf`,l.revealed.then((()=>{o.renderModel(new a.MimeModel(n.content))})),e.shell.add(l,"main",{mode:"tab-after"})}})(e,n)}),t.addItem({command:r,category:"notebook"})}}}}]);